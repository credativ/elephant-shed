{% extends "frame.html" %}
{% block mainwindow %}


<div class="row">
	<div class="col-sm-4">

<div class="panel panel-default">
  <div class="panel-heading" style="font-weight: bold">
	  <a href="{{url_for("index")}}">Shed</a> /  {{  detail_host }} / {{ detail_version }}-{{detail_cluster}}
  </div>
  <div class="panel-body" >
 <div class="btn-group">
	 <!--
	Possible States:
	online
	offlie
	recovery
	no-recovery
	 -->
	  <button type="button" class="btn btn-primary state-disable-for-online" onclick="pg_ctl( { x: this, host:  '{{ detail_host }}', version:  '{{ detail_version }}', cluster: '{{ detail_cluster }}',action:  'start', call_success: fill_details} )">Start</button>
 <button type="button" class="btn btn-primary state-disable-for-offline"         onclick="pg_ctl( { x: this, host:  '{{ detail_host }}', version:  '{{ detail_version }}', cluster: '{{ detail_cluster }}',action:  'stop', call_success: fill_details}) ">Stop</button>
 <button type="button" class="btn btn-primary state-disable-for-offline"         onclick="pg_ctl( { x: this, host:  '{{ detail_host }}', version:  '{{ detail_version }}', cluster: '{{ detail_cluster }}',action:  'reload', call_success: fill_details})">Reload</button>
 <button type="button" class="btn btn-primary state-disable-for-offline"         onclick="pg_ctl( { x: this, host:  '{{ detail_host }}', version:  '{{ detail_version }}', cluster: '{{ detail_cluster }}',action:  'restart', call_success: fill_details})">Restart</button>
 <button type="button" class="btn btn-primary state-disable-for-no-recovery state-disable-for-offline" onclick="pg_ctl(  { x: this, host:  '{{ detail_host }}', version:  '{{ detail_version }}', cluster: '{{ detail_cluster }}',action:  'promote', call_success: fill_details}) )" >Promote</button>
 <button type="button" class="btn btn-primary state-disable-for-online"  onclick="pg_ctl(  { x: this, host:  '{{ detail_host }}', version:  '{{ detail_version }}', cluster: '{{ detail_cluster }}',action: 'remove', call_success: goto_dash} ) ">Remove</button>
 </div>
 <br>State: 
 <span class="pg_state"style="font-size: 32px"></span><br>
  <span id="pg_log"></span>

  </div>

	
</div>

	</div>

	<div class="col-sm-8">

<div class="panel panel-default">
	<!--  <div class="panel-heading" style="font-weight: bold">Utilities</div>-->
  <div class="panel-body" >
 <div class="btn-group btn-group-justified">
	 {% for deeplink in environment['deeplinks'] %}
	 {% if loop.index0 % 4 == 0 %}
		 </div>
	 	<div class="btn-group btn-group-justified">
	 {% endif %}
	 <div class="btn-group btn-group-justified">
		 <button type="button" class="btn btn-primary" onclick="window.location='https://{{ detail_host }}{{deeplink['url'] }}'" >
			 <img src="{{ url_for('index') }}static/{{ deeplink["image"] }}" style="height:40px"><br>
			 	{{ deeplink["label"] }}
		 </button>
	 </div>
	{% endfor %}
 </div>
 
  </div>

	
</div>

	</div>




	</div>

<div class="row">
	<div class="col-sm-4">
		<div class="panel panel-default">
		  <div class="panel-heading" style="font-weight: bold"> System-Information  </div>
		  <div class="panel-body" >
			  <table class="table table-responsive">
			  {% for element in environment['detailview_system'] %}
			  <tr class="es_disabled">
				{% if 'formoverride' in element %}
					<td>{{element['label']}}</td><td>{{ element['formoverride'] | safe }}</td>
				{% else %}
					<td>{{element['label']}}</td><td><span class="{{element['data']}}">unknown</span> </td>
				{% endif %}
			    <tr>
			  {% endfor %}
			  </table>
			  <br>
		  </div>
		</div>
	</div>
   <div class="col-sm-8">
	<div class="panel panel-default">
	  <div class="panel-heading" style="font-weight: bold">
	  Cluster-Configuration
	  </div>
  <div class="panel-body" >
	  <table class="table table-responsive">
		  <tr><td><b>URL:</b></td><td>postgresql://{{ detail_host}}:<span class="pg_port"></span>/postgres<br>
					      host={{ detail_host}} port=<span class="pg_port"></span>	</td></tr>
		  <tr><td><b>ClusterName:</b></td><td> <span class="pg_cluster"></span>		</td></tr>
		  <tr><td><b>Version</b></td><td><span class="pg_version"></span>		</td></tr>

			  {% for element in environment['detailview_cluster'] %}
			  <tr class="es_disabled">
				{% if 'formoverride' in element %}
					<td>{{element['label']}}</td><td>{{ element['formoverride'] | safe }}</td>
				{% else %}
					<td>{{element['label']}}</td><td><span class="{{element['data']}}">default</span> </td>
				{% endif %}
			  </tr>
			  {% endfor %}
				<tr>
					<td><input type="text" class="config-name form-control"></td>
					<td><input type="text" class="config-value form-control">
						<button type="button" class="btn btn-primary" onclick="update_conf( this, '{{detail_host}}','{{detail_version}}','{{detail_cluster}}'  )">Save</button>
					 </td>
				</tr>

			  </table>
	 <button type="button" class="btn btn-primary"  
		 	onclick=" ">Edit-Configuration</button>

  </div>
</div>



</div>

{% import 'makros/utils.html' as utils %}
{{ utils.clusterctl_js() }}
<script>

$(document).ready(function() {
	get_host( '{{ detail_host }}', '{{ detail_cluster }}', '{{ detail_version }}' ) ;
});



</script>
{% endblock %}
